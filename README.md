# ЛР №4-5. Реалізація симетричного шифрування з використанням AES

### 1.Генерація ключів на основі пароля
Генерація криптографічного ключа здійснюється на основі введеного користувачем пароля з використанням алгоритму PBKDF2. Пароль не зберігається у файловій системі, а використовується виключно як вхідний параметр для функції похідної ключа разом із випадковим сольовим значенням. Такий підхід дозволяє забезпечити стійкість до атак перебору та відповідає сучасним рекомендаціям з управління криптографічними ключами.

### 2. AES-шифрування у режимах CBC та GCM
У межах даного пункту реалізовано симетричне шифрування даних із використанням алгоритму AES у режимах CBC та GCM з можливістю динамічного вибору режиму через інтерфейс командного рядка, що забезпечує гнучкість налаштування та потенційну розширюваність криптографічного модуля.
Для режиму AES-CBC використовується вектор ініціалізації та механізм доповнення даних, а також реалізовано перевірку цілісності даних на основі криптографічного коду автентифікації повідомлень (HMAC). Під час практичного тестування шифрування в режимі CBC виконувалося коректно, однак на етапі дешифрування фіксувалася помилка перевірки підпису (Signature did not match digest), що свідчить про спрацьовування механізму контролю цілісності. Зазначена особливість реалізації не була усунута в межах даної лабораторної роботи.
Режим AES-GCM реалізовано як автентифікований режим шифрування, який забезпечує одночасно конфіденційність і цілісність інформації за рахунок використання тега автентифікації. Для кожної операції автоматично генерується унікальний вектор ініціалізації (nonce). Практичні тести підтвердили коректну роботу як шифрування, так і дешифрування даних у режимі AES-GCM.

### 3. Аналіз продуктивності режимів AES
У межах пункту 3 лабораторної роботи було виконано вимірювання продуктивності алгоритму AES у режимах CBC та GCM. Тестування проводилося на файлах розміром 1 МБ, 5 МБ та 10 МБ з повторенням операцій для підвищення достовірності результатів. Фіксувався час шифрування та дешифрування, а також перевірявся факт коректного відновлення даних. За результатами експерименту встановлено, що режим AES-GCM демонструє вищу швидкодію шифрування для всіх досліджуваних розмірів файлів. Під час дешифрування в режимі GCM спостерігається додатковий часовий наклад, зумовлений перевіркою тега автентифікації, проте всі операції завершувалися успішно, що підтверджує коректну роботу механізмів контролю цілісності та автентичності даних. Режим AES-CBC показав прийнятні показники швидкодії, однак під час дешифрування фіксувалася помилка перевірки HMAC, що свідчить про спрацьовування механізму контролю цілісності. Зазначену особливість реалізації не було усунено в межах даної лабораторної роботи. Отримані результати підтверджують, що режим AES-GCM є більш доцільним для практичного використання, оскільки поєднує високу продуктивність із вбудованим захистом цілісності даних.
Інформація з бенчмарку:
| Size | Mode | Enc (s) | Dec (s) | Enc MB/s | Dec MB/s | OK |
|---|---|---:|---:|---:|---:|:--:|
| 1.0MB | CBC | 0.003 | 0.001 | 313.0 | 686.1 | ❌ |
| 1.0MB | CBC | 0.007 | 0.002 | 137.4 | 525.1 | ❌ |
| 1.0MB | CBC | 0.003 | 0.002 | 322.9 | 571.1 | ❌ |
| 1.0MB | GCM | 0.001 | 0.002 | 700.9 | 623.9 | ✅ |
| 1.0MB | GCM | 0.002 | 0.003 | 590.1 | 374.7 | ✅ |
| 1.0MB | GCM | 0.002 | 0.003 | 593.0 | 350.9 | ✅ |
| 5.0MB | CBC | 0.012 | 0.009 | 425.9 | 586.1 | ❌ |
| 5.0MB | CBC | 0.013 | 0.008 | 378.7 | 618.7 | ❌ |
| 5.0MB | CBC | 0.015 | 0.007 | 342.6 | 739.5 | ❌ |
| 5.0MB | GCM | 0.004 | 0.011 | 1235.5 | 441.0 | ✅ |
| 5.0MB | GCM | 0.009 | 0.014 | 544.1 | 350.0 | ✅ |
| 5.0MB | GCM | 0.006 | 0.014 | 770.5 | 359.8 | ✅ |
| 10.0MB | CBC | 0.019 | 0.016 | 535.8 | 640.3 | ❌ |
| 10.0MB | CBC | 0.033 | 0.015 | 301.2 | 686.1 | ❌ |
| 10.0MB | CBC | 0.028 | 0.015 | 357.3 | 674.9 | ❌ |
| 10.0MB | GCM | 0.009 | 0.030 | 1144.7 | 338.8 | ✅ |
| 10.0MB | GCM | 0.016 | 0.031 | 644.6 | 317.8 | ✅ |
| 10.0MB | GCM | 0.015 | 0.028 | 665.2 | 361.0 | ✅ |

### 4. Інтеграція криптомодуля у тестовий консольний застосунок
У межах пункту 4 криптографічний модуль було інтегровано у консольний застосунок `aes_cli.py`, який забезпечує повний цикл обробки файлів: шифрування, дешифрування та керування ключами. Застосунок приймає файл на вхід, дозволяє задати режим роботи AES (CBC або GCM), шлях до вихідного файлу та інші параметри. Генерація ключів здійснюється за допомогою PBKDF2 з використанням випадкового salt, а їх зберігання реалізоване у вигляді структурованого keystore без розміщення відкритих ключових матеріалів на диску. Практичне тестування підтвердило можливість динамічно змінювати режим шифрування без перезапуску програми, що досягається завдяки передачі параметра `--mode` у командному рядку. У режимі AES-GCM виконано повний цикл шифрування й успішного дешифрування з відновленням вихідного файлу. Механізм контролю цілісності сигналізує про помилки у випадку пошкодження контейнера або невідповідності тега автентифікації, що свідчить про коректну роботу засобів захисту.

### 5. Журналювання подій та виявлення помилок
У проєкті реалізовано систему журналювання, що автоматично записує всі операції шифрування та дешифрування у файл `logs/aes.jsonl` у форматі JSON-lines. Для кожної події фіксуються час, режим роботи AES, шляхи до вхідного та вихідного файлів, статус виконання, а у разі помилки – детальне повідомлення.
Під час тестування система коректно зафіксувала як успішні операції AES-GCM, так і типові помилки, що виникають у режимі AES-CBC-HMAC. Зокрема, логами зафіксовано випадки:  
- успішного шифрування та дешифрування GCM з валідним тегом автентифікації;  
- помилки доступу до неіснуючого файлу;  
- невідповідності HMAC-підпису (`Signature did not match digest`), що вказує на пошкодження або модифікацію зашифрованих даних.
Логи можуть використовуватися для аудиту операцій, виявлення спроб підміни або пошкодження файлів, а також для подальшого посилення безпеки через аналіз повторюваних помилок та відхилень у роботі криптомодуля. Формат JSON-lines дозволяє легко інтегрувати систему журналювання зі сторонніми засобами моніторингу та SIEM-рішеннями.

### 6.Імітація підміни зашифрованих даних
У межах виконання шостого пункту лабораторної роботи було проведено моделювання спроби несанкціонованої модифікації зашифрованого файлу з метою оцінки стійкості реалізованих криптографічних механізмів. Для цього був штучно змінений окремий байт у шифртексті та модифіковано цілий файл шляхом додавання некоректних даних. Після внесення навмисних спотворень було виконано процедуру дешифрування з використанням режиму AES-GCM.
Отримані результати підтвердили, що режим GCM коректно виявляє факт втручання, оскільки при пошкодженні шифртексту модуль дешифрування генерує помилку InvalidTag, що фіксується також у журналі подій logs/aes.jsonl. Це свідчить про спрацювання механізму перевірки автентичності даних (AEAD), який є ключовою перевагою режиму GCM над неавтентифікованими режимами. Проведений експеримент доводить, що реалізований криптомодуль здатний виявляти спроби підміни або модифікації зашифрованої інформації, що відповідає сучасним вимогам до безпеки передавання та зберігання конфіденційних даних. Режим AES-GCM може бути рекомендований для використання у системах, критичних до цілісності даних, тоді як застосування CBC-HMAC потребує додаткового аудитування через виявлені проблеми з перевіркою тегу.
